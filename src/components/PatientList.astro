---
const { patients } = Astro.props;
---

<section class="bg-white dark:bg-gray-800 shadow-sm rounded-lg overflow-hidden">
  <h2 class="text-center text-3xl font-semibold">Pacientes Registrados</h2>
  <ul class="divide-y divide-gray-200 dark:divide-gray-700">
    {
      patients?.length > 0 ? (
        patients.map((patient) => (
          <li>
            <a
              href={`/patient/${patient._id}`}
              class="block hover:bg-gray-50 dark:hover:bg-gray-700 transition duration-150 ease-in-out"
            >
              <div class="px-4 py-4 sm:px-6">
                <div class="flex items-center justify-between">
                  <p class="text-sm font-medium text-indigo-600 dark:text-indigo-400 truncate">
                    {patient.fullName}
                  </p>
                  <div class="ml-2 flex-shrink-0 flex">
                    <p class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-700 dark:text-green-100">
                      Activo
                    </p>
                  </div>
                </div>
                <div class="mt-2 sm:flex sm:justify-between">
                  <div class="sm:flex">
                    <p class="flex items-center text-sm text-gray-500 dark:text-gray-300">
                      {patient.age} años
                    </p>
                  </div>
                  <div class="mt-2 flex items-center text-sm text-gray-500 dark:text-gray-300 sm:mt-0">
                    Última visita:{" "}
                    {patient.consultations && patient.consultations.length > 0
                      ? new Date(
                          patient.consultations[
                            patient.consultations.length - 1
                          ].date
                        ).toLocaleDateString()
                      : "Sin consultas"}
                  </div>
                </div>
              </div>
            </a>
          </li>
        ))
      ) : (
        <li class="px-4 py-4 sm:px-6 text-sm text-gray-500 dark:text-gray-300">
          No hay pacientes disponibles.
        </li>
      )
    }
  </ul>
</section>
